define("sjplus/global/0.0.1/login/login",["popup","sjplus/global/0.0.1/crypto/sha3","./login.tpl","template"],function(a,b){function c(a){if(this.action.indexOf("/login")>-1){a.preventDefault();var b=$.trim(this.elements["user-name"].value),c=$.trim(this.elements.pwd.value);if(b.length<2)return e(),void 0;if(c.length<2)return e(),void 0;$.post("/login",{_:b,__:j(c).toString(),_csrf:function(){return window._csrf_token_}()},function(a){if(a&&a.userSessionNotice&&k.keys(a.userSessionNotice).length>0)return window.location.reload(),void 0;switch(g(a._csrf_token_),a.status){case 1:d(a);break;case-1:e();break;case-2:e()}for(var b=0,c=n.length;c>b;b++)n.shift()(a)},"json")}}function d(a){o&&o.element&&o.element.fadeOut(100),$(".J-login-register-triggers").css({marginTop:-19}),$(".login-user-info").css({top:0}),$(".login-user-info img").css({width:20,height:20,opacity:1}),f(a)}function e(){var a=$("#loginSmallDialog").stop();a.animate({marginLeft:"-10"},80,function(){a.animate({marginLeft:"10"},80,function(){a.animate({marginLeft:"-10"},80,function(){a.animate({marginLeft:"10"},80,function(){a.animate({marginLeft:"-10"},80,function(){a.animate({marginLeft:"0"},80)})})})})})}function f(){new i({trigger:".J-logged-list-triggers",triggerType:"click",element:$("#logged-wrapper").html(),delegateNode:document.body,effect:"slide",align:{baseXY:[-56,16]}})}function g(a){window._csrf_token_=a,$("input[name=_csrf]").val(a)}var h=$("#login-register-area"),i=a("popup"),j=a("sjplus/global/0.0.1/crypto/sha3"),k=KISSY;h.mouseenter(function(){h.find(".J-spector").stop(!0,!0),h.find(".J-spector").animate({opacity:0},200)}).mouseleave(function(){h.find(".J-spector").animate({opacity:1},200)});var l=a("./login.tpl"),m=a("template"),n=[],o=new i({trigger:".J-login-triggers",triggerType:"click",element:m.render(l,{}),delegateNode:document.body,effect:"slide",align:{baseXY:[-180,-20]}});b.login=function(a){o.show(),"function"==typeof a&&n.push(a)},$("#login-trigger").on("click",".trigger",function(a){a.preventDefault();var b=$(this);b.siblings().animate({opacity:0},200),setTimeout(function(){b.siblings().animate({width:0},300,function(){$("div.login-small-dialog form").fadeIn(200,function(){$("#J-login-user-name-field").focus()})})},100)}),o.on("animated",function(){$("#J-login-user-name-field").focus()}),$.ajax({url:"/login/is-login",data:{},dataType:"jsonp"}).done(function(a){g(a._csrf_token_),$(document).on("submit","form",c),1==a.status&&d(a)}),b.updateCsrfToken=g}),define("sjplus/global/0.0.1/login/login.tpl",[],'<div id="loginSmallDialog" class="login-small-dialog">\n    <div class="wrapper">\n\n        <h2>登 陆</h2>\n\n        <div id="login-trigger">\n            <div class="trigger">\n                <a id="domain-login"><span><!--域帐号--></span></a>\n            </div>\n            <!--<div class="trigger">\n                <a id="email-login"><span>邮箱登陆</span></a>\n            </div>-->\n            <!--<div class="trigger">\n                <a id="weibo-login"><span>微博登陆</span></a>\n            </div>-->\n\n        </div>\n\n        <form action="/login" method="post">\n            <input class="text" type="text" name="user-name" placeholder="用户名" id="J-login-user-name-field">\n            <input class="text" type="password" name="pwd" placeholder="密码">\n            <input class="btn J-login-submit-triggers" type="submit" value="登陆"/>\n        </form>\n    </div>\n</div>\n');

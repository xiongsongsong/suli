define("sjplus/global/0.0.1/login/login",["popup","sjplus/global/0.0.1/crypto/sha3","./login.tpl","template"],function(a,b){function c(a){if(this.action.indexOf("/login")>-1){a.preventDefault();var b=$.trim(this.elements["user-name"].value),c=$.trim(this.elements.pwd.value);if(b.length<2)return e(),void 0;if(c.length<2)return e(),void 0;$.post("/login",{_:b,__:j(c).toString(),_csrf:function(){return window._csrf_token_}()},function(a){switch(g(a._csrf_token_),a.status){case 1:d(a);break;case-1:e();break;case-2:e()}for(var b=0,c=m.length;c>b;b++)m.shift()(a)},"json")}}function d(a){n&&n.element&&n.element.fadeOut(100);var b=l.render(k,a);h.append($(b)),$(".J-login-register-triggers").css({marginTop:-19}),$(".login-user-info").css({top:0}),$(".login-user-info img").css({width:20,height:20,opacity:1}),f(a)}function e(){var a=$("#loginSmallDialog").stop();a.animate({marginLeft:"-10"},80,function(){a.animate({marginLeft:"10"},80,function(){a.animate({marginLeft:"-10"},80,function(){a.animate({marginLeft:"10"},80,function(){a.animate({marginLeft:"-10"},80,function(){a.animate({marginLeft:"0"},80)})})})})})}function f(a){new i({trigger:".J-logged-list-triggers",triggerType:"click",element:l.render(k,{_id:a._id,status:"logged"}),delegateNode:document.body,effect:"slide"})}function g(a){window._csrf_token_=a,$("input[name=_csrf]").val(a)}var h=$("#login-register-area"),i=a("popup"),j=a("sjplus/global/0.0.1/crypto/sha3");h.mouseenter(function(){h.find(".J-spector").stop(!0,!0),h.find(".J-spector").animate({opacity:0},200)}).mouseleave(function(){h.find(".J-spector").animate({opacity:1},200)});var k=a("./login.tpl"),l=a("template"),m=[],n=new i({trigger:".J-login-triggers",triggerType:"click",element:l.render(k,{status:"0"}),delegateNode:document.body,effect:"slide",align:{baseXY:[-180,-20]}});b.login=function(a){n.show(),"function"==typeof a&&m.push(a)},$("#login-trigger").on("click",".trigger",function(a){a.preventDefault();var b=$(this);b.siblings().animate({opacity:0},200),setTimeout(function(){b.siblings().animate({width:0},300,function(){$("div.login-small-dialog form").fadeIn(200,function(){$("#J-login-user-name-field").focus()})})},100)}),n.on("animated",function(){$("#J-login-user-name-field").focus()}),$.ajax({url:"/login/is-login",data:{},dataType:"jsonp"}).done(function(a){$("#login-register-area").addClass("show"),g(a._csrf_token_),$(document).on("submit","form",c),1==a.status&&d(a)}),b.updateCsrfToken=g}),define("sjplus/global/0.0.1/login/login.tpl",[],'#if(status<1)\n\n<div id="loginSmallDialog" class="login-small-dialog">\n    <div class="wrapper">\n\n        <h2>登 陆</h2>\n\n        <div id="login-trigger">\n            <div class="trigger">\n                <a id="domain-login" href=""><span><!--域帐号--></span></a>\n            </div>\n            <!--<div class="trigger">\n                <a id="email-login" href=""><span>邮箱登陆</span></a>\n            </div>-->\n            <!--<div class="trigger">\n                <a id="weibo-login" href=""><span>微博登陆</span></a>\n            </div>-->\n\n        </div>\n\n        <form action="/login" method="post">\n            <input class="text" type="text" name="user-name" placeholder="用户名" id="J-login-user-name-field">\n            <input class="text" type="password" name="pwd" placeholder="密码">\n            <input class="btn J-login-submit-triggers" type="submit" value="登陆"/>\n        </form>\n    </div>\n</div>\n\n#elseif(status==1)\n\n<div class="login-user-info J-logged-list-triggers">\n\n    <span class="avatar">\n        <a><img class="J-avatar-own-20" src="#{imgCDN}/avatar/#{_id}_20x20"><i></i></a>\n    </span>\n    <span class="J-user-name">#{user}</span>\n</div>\n\n#elseif(status=="logged")\n<div class="logged-list J-logged-list">\n    <div class="list">\n        <ul>\n            <li><a href="/u/#{_id}">我的主页</a></li>\n            <li><a class="J-publish-work">发布作品</a></li>\n            <li><a href=\'/personal#all-works{"view":"design"}\'>管理设计作品</a></li>\n            <li><a href="/personal#account-setting">帐号设置，头像</a></li>\n            <li><a href="/login/login-out">退出</a></li>\n        </ul>\n    </div>\n</div>\n#end');

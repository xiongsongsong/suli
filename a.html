<script src="http://a.tbcdn.cn/p/snsdk/core.js"></script>
<style>

#J-beyondsoft-draw-form {

    width: 486px;

    padding: 12px 0;

    border: solid 10px #a00;

    background: #fff;

}



#J-beyondsoft-draw-form table {

    margin: 0 0 0 12px;

}



#J-beyondsoft-draw-form tr.th td {

    padding: 12px 0;

}



#J-beyondsoft-draw-form tr.J-b-smt td {

    text-align: center;

}



#J-beyondsoft-draw-form th,

#J-beyondsoft-draw-form td {

    padding: 5px 12px;

    vertical-align: middle;

}



#J-beyondsoft-draw-form input.J-b-text-field {

    width: 240px;

    padding: 3px 5px;

}



#J-beyondsoft-draw-form th {

    text-align: right;

}



#J-beyondsoft-draw-form input.J-b-submit-adderss {

    display: block;

    margin: 0 auto;

    width: 120px;

    padding: 12px 0;

}



.J-beyondsoft-draw .ks-ext-close {

    position: absolute;

    right: 0;

    top: 0;

    background: #a00;

    color: #fff;

    padding: 12px 22px;

    border-bottom-left-radius: 5px;

}


#cj-container {
    background-image: url(http://gtms02.alicdn.com/tps/i2/T1xsjeFfXXXXbCwcDW-574-5951.png);
    width: 574px;
    height: 541px;
    float: left;
    margin-top: 82px;
    margin-left: 31px;
}

.draw1 {
    background-position: 0 -541px;
}

.draw2 {
    background-position: 0 -1082px;
}

.draw3 {
    background-position: 0 -1623px;
}

.draw4 {
    background-position: 0 -2164px;
}

.draw5 {
    background-position: 0 -2705px;
}

.draw6 {
    background-position: 0 -3246px;
}

.draw7 {
    background-position: 0 -3787px;
}

.draw8 {
    background-position: 0 -4328px;
}

.draw9 {
    background-position: 0 -4869px;
}

.draw10 {
    background-position: 0 -5410px;
}

#start-game {
    width: 197px;
    height: 198px;
    background: url(http://img02.taobaocdn.com/tps/i2/T1Fz14XcBXXXXXXXXX-20-40.png) -999em -999em no-repeat;
    cursor: pointer;
    margin-left: 180px;
    margin-top: 172px;
    display: block;
}

.J-b-bingo {
    background: #fff url(http://gtms02.alicdn.com/tps/i2/T1Pc_OXaVrXXbpEUIC-326-107.png) center 30px no-repeat;
    width: 426px;
    height: 247px;
    border: solid 3px #04638b
}

#page, #header, #content, #footer {
    width: auto;
}

.J-b-bingo p.name {
    color: #fc4462;
    position: absolute;
    left: 62px;
    top: 142px;
    font-size: 16px;
    font-weight: bold;
    font-family: simsun;
}

.J-b-bingo a.J-b-address {
    position: absolute;
    right: 69px;
    top: 152px;
    cursor: pointer;
}

.J-b-bingo a.J-b-share-sns {
    position: absolute;
    right: 68px;
    bottom: 22px;
    cursor: pointer;
}

#main-banner {
    background: url(http://gtms03.alicdn.com/tps/i3/T1Ppq0FkphXXcOz.PD-1680-609.jpg) center 0 no-repeat;
    height:609px;
}

#cj-container {


}

.game-rule {
    color: #58DFF5;
    width: 279px;
    font-size: 13px;
}
#rule-and-info{
    float: right;
    width: 279px;
    padding: 192px 56px 0 0;
}
.J-bingo-list {
    width: 306px;
    font-size: 14px;
    color: #58DFF5;
    height: 150px;
    overflow: hidden;
    margin-top: 88px;

}

.J-bingo-list b {
    color: #fc4462;
    font-weight: normal;
    margin-left: 4px;
}

.item-wrapper {
    background:#003b8a url(http://gtms04.alicdn.com/tps/i4/T1E4PgFXxgXXaSkeMn-1045-44.png) center 0 repeat-y;
    padding-bottom:45px;
}

.item-wrapper .content {
    width: 990px;
    margin: 0 auto;
}

#free-try div.list {
    width: 990px;
    overflow: hidden;
}

#free-try div.list ul {
    width: 1025px;
}

#free-try li {
    position: relative;
    background: url(http://gtms01.alicdn.com/tps/i1/T18YQvXa0hXXc.NI3a-311-360.png);
    width: 311px;
    height: 360px;
    font-family: "Microsoft Yahei", sans-serif;
    float: left;
    margin-right: 30px;
    margin-bottom: 30px;
}

#free-try li a {
    position: absolute;
    width: 100%;
    height: 100%;
}

#free-try li a img {
    position: absolute;
    left: 0;
    top: 0;
    width: 310px;
    height: 310px;
}

#free-try li a span.title {
    position: absolute;
    left: 13px;
    top: 283px;
    color: #000;
    font-weight: bold;
    background: #fff;
    font-size: 14px;
    padding: 0 9px;
}

#free-try li a span.des {
    position: absolute;
    left: 54px;
    top: 317px;
    color: #fff;
    width: 159px;
}

#cj-content{
    background: url(http://gtms02.alicdn.com/tps/i2/T1AF0IFc4aXXbyN9rh-990-666.png) center 0 no-repeat;
    height: 666px;
    margin: 0 auto;
}
#p4p-container{

}
#p4p-container .content{
    width: 945px;
    overflow: hidden;
    margin: 0 auto;
    background: #ED3966;
    border: solid 1px #FF749D;
    padding: 23px;
}

.item-p4p {
    width: 990px;
    overflow: hidden;
    margin: 0 auto;
}

.item-p4p a {
    float: left;
    width: 170px;
    height: 170px;
    margin-right: 23px;
    margin-bottom: 13px;
    position: relative;
    overflow: hidden;
}

.item-p4p a b.title {
    position: absolute;
    filter: progid:DXImageTransform.Microsoft.gradient(enabled='true', startColorstr='#CCFFFFFF', endColorstr='#CCFFFFFF');
    background: rgba(255, 255, 255, 0.8);
    left: 0;
    bottom: 0;
    width: 100%;
    padding: 5px 0;
    white-space: nowrap;
    font-weight:normal;
    color: #6d6865;
}

.item-p4p a b.price{
    position: absolute;
    bottom: 5px;
    right: 6px;
    font-weight: bold;
    color: #205f94;
}

.item-p4p a i{
    white-space: nowrap;
    display:block;
    overflow:hidden;
    text-overflow: ellipsis;
    width: 70%;
    font-style:normal;
}
.item-p4p .wrapper {
    width: 990px
}

.p4p-container {
    background: #ce8498;
    border-bottom: solid 3px #b8637a;
}
.p4p-container a{
    float: left;
    width: 170px;
    height: 170px;
    margin-right: 13px;
    margin-bottom: 13px;
    position: relative;
}

.p4p-container a img{
    width: 170px;
    height: 170px;
}

.p4p-container a b.title{
    position: absolute;
    left: 0;
    bottom:0
}

.p4p-container a b.price{
    position: absolute;
    right: 0;
    bottom: 0;
}

</style>




<script>
KISSY.add("beyondsoft/draw", function (S, O) {

    var DOM = KISSY.DOM, Event = S.Event;

    var UA = S.UA

    var addressTpl = '<form id="J-beyondsoft-draw-form"><table>' +
            '<tr class="th">' +
            '<td colspan="2">请填写您的详细收件地址，奖品将会在活动结束（10月13日）后10个工作日内发放。</td>' +
            '</tr>' +
            '<tr>' +
            '<th>收件人姓名：</th>' +
            '<td><input type="text" class="J-b-text-field" name="fullName"></td>' +
            '</tr>' +
            '<tr>' +
            '<th>收件人地址：</th>' +
            '<td><input type="text" class="J-b-text-field" name="address"></td>' +
            '</tr>' +
            '<tr>' +
            '<th>邮编：</th>' +
            '<td><input type="text" class="J-b-text-field" name="zip">' +
            '</tr>' +
            '<tr>' +
            '<th>联系电话：</th>' +
            '<td><input type="text" class="J-b-text-field" name="phone"></td>' +
            '</tr>' +
            '<tr class="J-b-smt">' +
            '<td colspan="2"><input type="button" value="提交" class="J-b-submit-adderss"></td>' +
            '</tr>' +
            '</table>' +
            '</form>'

    var dialog  = new S.Dialog({
        elCls: '.J-beyondsoft-draw',
        elStyle: {
            position: UA.ie == 6 ? "absolute" : "fixed"
        },
        bodyContent: '',
        mask: true,
        align: {
            points: ['cc', 'cc']
        }
    });

    function show() {
        dialog.show()
        dialog.center()
    }


    function cj(node, config) {
        this.config = config
        this._i = 0
        if (typeof node === 'string') node = DOM.get(node)
        this.node = node
        this.defaultTimer = 50
        //起步速度
        this.timer = this.defaultTimer
        //步数
        this.step = 0
        //setTimeout
        this.cl = false
        this.dialog = dialog
        var self = this

        Event.delegate(document.body, 'click', '.J-b-address', function () {
            self.address()
        })
        Event.delegate(document.body, 'click', '.J-b-submit-adderss', function (ev) {
            self.sendAddress(ev, {
                ruleId: self.config.ruleId,
                objId: self.objId
            })
        })
        Event.delegate(document.body, 'click', '.J-b-share-sns', function (ev) {
            S.log('开始触发SNS', self.bingoData, self)
            if (self.config.shareSnsContent) {
                S.log('开始检查是否有数据存在')
                if (self.bingoData && self.bingoData.user && self.bingoData.user.name) {
                    S.log('数据存在，开始启动SNS')
                    var config = {
                        "pic": "",
                        "client_id": "",
                        "comment": S.substitute(self.config.shareSnsContent, {name: self.bingoData.user.name}),
                        "title": "",
                        "isShowFriend": false,
                        "type": "webpage",
                        "key": location.href
                    }
                    if (typeof SNS !== 'undefined') {
                        SNS.ui("share", config)
                    } else {
                        S.getScript("http://a.tbcdn.cn/p/snsdk/core.js", function () {
                            if (typeof SNS !== 'undefined')  SNS.ui("share", config)
                        })
                    }
                }
            }
        })
        self.bingoList()
    }

    cj.prototype.stop = function () {
        clearTimeout(this.cl);
        this.step = 0
        this.cl = false
        this.timer = this.defaultTimer
        this._i = 0
    }

    function center() {
        S.log("ie center");
        if (dialog.get("visible")) {
            dialog.center();
        }
    }

    cj.prototype.showSNS=function(){

    }

    cj.prototype.showTip = function (str) {
        dialog.set('bodyContent', str)
        show()
    };

    cj.prototype.hideTip = function () {
        dialog.hide()
    };

    if (UA.ie == 6) {
        Event.on(window, "scroll", center);
    }

    Event.on(window, "resize", center);

    cj.prototype.address = function () {
        dialog.set('bodyContent', addressTpl)
        dialog.show()
    }

    cj.prototype.isRuning = function () {
        return this.cl !== false
    }

    cj.prototype.sendAddress = function (ev, obj) {
        var self = this
        var form = ev.target.form
        if (!form) return
        var data = S.unparam(S.IO.serialize(form))
        obj.type = 2
        obj.result = 'bingo_ad'
        obj._input_charset='utf-8'
        S.io({
            url: 'http://sales.taobao.com/tcp/recordAwardAddress.do',
            data: S.mix(data, obj),
            dataType: 'script',
            success: function () {
                if (self.config.sendAddressCallback) self.config.sendAddressCallback(window['bingo_ad'])
                self.node.className = ''
            }
        })
    }


    cj.prototype._start = function (num, fn) {
        var self = this
        this.step++
        this.cl = setTimeout(function () {
            var cur = self.config.prize[self._i++]
            self.node.className = self.config.cls + self._i
            S.log(num,self.config.prize)
            if (S.indexOf(num, self.config.prize) < 0) {
                self.node.className = '';
                self.stop()
                alert('系统错误，无法获取奖品信息')
                return
            }
            if (self._i >= self.config.prize.length) self._i = 0
            if (self.step > 50 && num === cur) {
                self.stop()
                if (fn) fn(num)
                return
            }
            self._start(num, fn)
        }, self.timer += (self.step > 20 ? 6 : 1))
    }

    //开始转圈
    cj.prototype.start = function (num, fn) {
        if (this.isRuning() === false) {
            this.objId = num
            this._start(num, fn)
        }
    }

    //抽奖
    cj.prototype.bingo = function (cb, param) {
        var self = this;
        if (this.isRuning() === false) {
            KISSY.io({
                url: 'http://sales.taobao.com/lottery/lottery.do',
                data: {
                    time: param.time,
                    ruleId: self.config.ruleId,
                    checkCode: self.config.checkCode,
                    ua: param.ua
                },
                dataType: 'jsonp',
                success: function (data) {
                    self.bingoData = data;
                    cb(data)
                }
            })
        }
    }

    //显示中奖记录
    cj.prototype.bingoList = function () {
        var node = DOM.query(this.config.bingoContainer)
        var self = this
        if (node.length > 0 && self.config.bingoKey) {
            S.io({
                url: 'http://sales.taobao.com/tcp/getAwardUsers.do',
                data: {
                    ruleId: self.config.bingoKey,
                    type: 2,
                    result: 'cj_b_list'
                },
                dataType: 'script',
                success: function () {
                    var list = window['cj_b_list']
                    if (list.is_success === 'T' && list.listInfo.length > 0) {
                        var html = ''
                        S.each(list.listInfo, function (item) {
                            html += '<li><span class="nick-name">' + item.nick + '</span>抽奖中了 <b class="bingo-name">' + item.award_name + '</b></li>'
                        })
                        DOM.html(node, html)
                    } else {
                        DOM.html(node, '<li class="nothing">暂无中奖记录。</li>')
                    }
                    if (self.config.bingoCallback) self.config.bingoCallback(node)
                }
            })
        }
    }

    return cj

}, {requires: ["dom", "event", 'ua', "overlay", "template" ]})


</script>

<div type="text/tpl" id="J-sucuess-tip" style="display: none">
    <div class="J-b-bingo">
        <p class="name">{{text}}</p>
        {{\#if isShowAddress}}
        <a class="J-b-address" title="填写收货地址">
            <img src="http://gtms01.alicdn.com/tps/i1/T13xG0Fb0bXXaeYm33-102-31.gif">
        </a>{{/if}}
        <a class="J-b-share-sns" title="{{name}}">
            <img src="http://gtms02.alicdn.com/tps/i2/T1fzrOXidjXXap1C33-102-31.png">
        </a>
    </div>
</div>


<style>
    .NoQualifications{background: url("http://gtms03.alicdn.com/tps/i3/T1cKYqFf0bXXbOLt.v-427-247.png") no-repeat;width: 427px;height: 247px;}
    .NoQualificationsct .focus{display:block;width: 142px;height: 40px;position: absolute;top:173px;left:140px;cursor: pointer;}
</style>
<script type="text/tpl" id="followTpl">
    <div class="NoQualifications">
        <div class="NoQualificationsct ct">
            <a href="javascript:void(0)" class="focus J-follow-aitao" target="_self"></a>
            <b class="J_close"></b>
        </div>
    </div>
</script>

<script type="text/javascript" src="http://www.taobao.com/go/act/xm-token.php"></script>

<script>
    var ua = "";
    var UA_Opt = new Object;
    UA_Opt.LogVal = "ua";
    UA_Opt.MaxMCLog = 3;
    UA_Opt.MaxMPLog = 3;
    UA_Opt.MaxKSLog = 3;
    UA_Opt.Token = new Date().getTime() + ":" + Math.random();
    UA_Opt.SendMethod = 8;
    UA_Opt.Flag = 14222;
</script>

<script type='text/javascript' src='http://uaction.aliyuncdn.com/actionlog/js/ua.js'></script>
<script>
KISSY.ready(function () {
    var ruleId = 2211

    var errMap = {
        E004: "您已经达到中奖次数限制啦",
        E007: "活动未开始",
        E008: "活动已结束",
        E011: "亲，请刷新页面重试",
        E014: "亲，您未登录或登陆超时",
        E019: "亲，您是小二账号吧，不能中奖哦",
        ES03: "亲，您未绑定支付宝",
        EW01: "亲，你的抽奖次数已经用完了",
        E015: "亲，您今天已经没有抽奖机会了哦",
        E016: "亲，您已经没有抽奖机会了哦"
    }

    var dzError = {
        "0001": "系统异常",
        "0002": "缺少抽奖规则ID",
        "0003": "缺少奖品 ID",
        "0004": "缺少真实姓名",
        "0005": "缺少邮编",
        "0006": "缺少联系电话",
        "0007": "缺少收货地址",
        "0008": "真实姓名过长",
        "0009": "邮编过长",
        "0010": "联系电话过长",
        "0011": "收货地址过长",
        "0012": "邮编格式非法",
        "0013": "奖品不存在",
        "0014": "奖品不属于该规则",
        "0015": "奖品不是实物奖品"
    }

    KISSY.use("beyondsoft/draw,template", function (S, Draw, Template) {

        var Event = S.Event, DOM = S.DOM

        //所有奖品，负数代表谢谢参与，多个谢谢参与请用-2     或者-2之类的
        //var 奖品ID =
        //var 实物ID =

        var draw = new Draw('#cj-container', {
            //所有奖品（包括“谢谢参与”）
            prize: ['5618', '-1', '5623', '5617' , '5620', '5616', '5619', '5622', '5616', '5621'],
            //测试 -> prize: ['5606', '-1', '5605', '5603' , '5601', '5597', '5593', '5592', '5591'],
            //实物奖品
            addressMap: ['5618', '5623', '5617' , '5620', '5619', '5622', '5621'],
            //测试 -> addressMap: ['5605', '5603' , '5601', '5597', '5593', '5592', '5591'],
            //精灵图的样式前缀
            cls: 'draw',
            //抽奖ID
            ruleId: ruleId,
            checkCode: "<?php echo MD5(time().'8c7ed1d306b3ebaa9ab5167d19b21ef7');?>",
            //抽奖相关的东西
            bingoKey: '958fe9a6ccf0a330f36fd2e43ff8cb46',
            bingoContainer: '.J-bingo-list-container',
            //中奖列表生成后的回调
            //可以在此函数中，开始处理动画效果
            bingoCallback: function (node) {
                KISSY.use("switchable", function (S, Switchable) {
                    var Slide = Switchable.Slide;
                    Slide(DOM.get('.J-bingo-list'), {
                        contentCls: 'ks-content',
                        hasTriggers: false,
                        effect: 'scrolly',
                        easing: 'easeOutStrong',
                        circle: true,
                        interval: 3,
                        duration: .2
                    });
                });
            },
            //发送地址的回调，参数为服务器返回的值
            sendAddressCallback: function (data) {
                S.log(data)
                if (data.isSuccess === 'T') {
                    draw.dialog.hide()
                    alert('提交成功，请耐心等待奖品')
                } else {
                    if (dzError[data.code]) {
                        alert(dzError[data.code])
                    } else {
                        alert('非法提交')
                        draw.dialog.hide()
                    }
                }
            },
            shareSnsContent:'我中了{name}，大家也来试试吧！！'
        })


        var successTpl = DOM.get('#J-sucuess-tip').innerHTML


        var taoZhiHaoID=384609349

        Event.on('#start-game', 'click', function () {
            S.io({
                url: 'http://aitao.taobao.com/tzh/json/apiCheckSubscribe.htm',
                data: {
                    tzhUserId: taoZhiHaoID,
                    tzhRoleType: 1
                },
                dataType: 'jsonp',
                success: function (data) {
                    //如果关注了淘字号
                    if (data.code == 0) {
                        bingStart()
                        return
                    }
                    if (data.code == -2) {
                        SNS.ui('login', {force: true})
                    }
                    //否则点击开始抽奖时，先提醒进行绑定
                    else {
                        draw.showTip(DOM.get('#followTpl').innerHTML)
                    }
                }
            })
        })

        //开始关注淘字号
        Event.delegate(document.body,'click','.J-follow-aitao',function(){
            draw.hideTip()
            var aiurl="http://jianghu.taobao.com/admin/follow/follow_taozihao.htm?user_id=384609349&type=204&appId=1100044&role_id=1&_tb_token_="+xm_tb_token_+"&callback=aijiaguan.result";
            aiurl+="&ua="+encodeURIComponent(ua);
            UA_Opt.Token=new Date().getTime()+":"+Math.random();
            UA_Opt.reload();
            KISSY.getScript(aiurl);
        })

        //开始抽奖
        function bingStart(){
            //防止重复点击抽奖
            if (draw.isRuning() === false) {
                draw.bingo(function (data) {
                    switch (data.isSuccess) {
                        case "T":
                            //开始播放动画，fn为动画完成的回调
                            draw.start(data.user.award_id, function () {
                                //显示中了什么
                                draw.showTip(Template(successTpl).render({
                                    //中了什么
                                    text: data.user.name,
                                    //是否显示地址框
                                    isShowAddress: S.indexOf(data.user.award_id, draw.config.addressMap) > -1
                                }))
                            })
                            break;
                        case "F":
                            if(data.error==='F'){
                                //开始播放动画，fn为动画完成的回调
                                draw.start('-1', function () {
                                    alert('很遗憾，您未中奖，请再试一次！')
                                })
                                return
                            }
                            if(data.error==='E014'){
                                //SNS.login()
                                SNS.ui('login',{force:true})
                            }else{
                                if(data.error){
                                    if(errMap[data.error]){
                                        alert(errMap[data.error])
                                    }else{
                                        draw.start('-1', function () {
                                            alert('系统错误，请稍后再试。')
                                        })
                                    }
                                }else{
                                    //开始播放动画，fn为动画完成的回调
                                    draw.start('-1', function () {
                                        alert('很遗憾，您未中奖，请再试一次或明天再来噢！')
                                    })
                                }
                            }
                            break;
                    }
                }, {time: '<?php echo time();?>', ua: ua})
                UA_Opt.Token = new Date().getTime() + ":" + Math.random();
                UA_Opt.reload();
            }
        }


    })
})
</script>


<div class="item-wrapper" id="p4p-container" style="background-image:url(http://gtms03.alicdn.com/tps/i3/T1lgnjFhJcXXa838.w-1680-2822.jpg);padding-top:576px;">
    <div class="content">
        <cms:repeat row="10" group="P4P" name="b0e7c89c-e7cd-4c6e-a620-2234c978e6be">
            <div class="item-p4p">
                <cms:custom group="p4p" title="p4p参数" fields="id:ID:string,pid:PID:string,count:个数:string" row="10" defaultRow="1" name="80256d70-4cb1-4ca1-8369-22f3f2687c9e">
                    #foreach($item in $customList)
                    <span class="p4p J-p4p-trigger" data-id="$!item.id" data-count="$!item.count" data-pid="$!item.pid"></span>
                    #end
                </cms:custom>
            </div>
        </cms:repeat>
    </div>
</div>

<div class="item-wrapper">
    <div class="content">
        <div id="cj-content">
            <div id="cj-container">
                <b id="start-game" class="cj-trigger"></b>
            </div>
            <div id="rule-and-info">
                <div class="game-rule">
                    <ul>
                        <li>1.关注淘宝车生活爱淘，即可参与抽奖。</li>
                        <li>2.每人每天有3次抽奖机会。</li>
                        <li>3.活动时间为9月23日—10月13日，共20天。</li>
                        <li>4.优惠券使用时间：9月23日—10月31日。</li>
                        <li>5.除优惠券外，所有奖品等到活动结束（10月13日）后10个工作日内安排发放</li>
                    </ul>
                </div>
                <div class="J-bingo-list">
                    <ul class="J-bingo-list-container ks-content">
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="item-wrapper" id="free-try">
    <div class="content">
        <h2><img src="http://gtms01.alicdn.com/tps/i1/T16y57Fd8hXXcGLxPs-990-60.png"></h2>

        <div class="list">
            <ul class="clearfix">
                <cms:custom group="第二章" title="图文列表" row="100" defaultRow="10" fields="img:图片地址:img,href:链接:url,title:标题:string,des:描述:string" name="75cc985f-6170-43e7-9960-415c1023ea8e">
                    #foreach($item in $customList)
                    <li><a href="$!item.href" target="_blank">
                        <img src="$!item.img" alt=""/>
                        <span class="title">$!item.title</span>
                        <span class="des">$!item.des</span>
                    </a>
                    </li>
                    #end
                </cms:custom>
            </ul>
        </div>
    </div>
</div>
<script id="item-p4p-tpl" type="text/tcl">
    <a href="{{eurl}}" target="_blank">
        <img src="{{pictureUrl}}">
        <b class="title"><i>{{itemTitle}}</i></b>
        <b class="price"><% print((activityPrice / 100).toFixed(2)); %></b>
    </a>
</script>

<script src="http://a.tbcdn.cn/apps/hesper/vc/p4p/p4p.js" charset="utf-8"></script>
<script>
    KISSY.ready(function (S) {
        var DOM = S.DOM;
        var tpl = S.DOM.get('#item-p4p-tpl').innerHTML
        S.each(DOM.query('.J-p4p-trigger', DOM.get('#p4p-container')), function (item) {
            var node = S.one(item)
            item.id = 'p4p' + node.attr('data-id')
            p4p.getItems({
                activity_id: node.attr('data-id'),
                blocks: [
                    {
                        id: node.attr('data-id'),
                        pid: node.attr('data-pid'),
                        count: parseInt(node.attr('data-count'), 10),
                        tmpl: tpl,
                        resultContainer: '#' + item.id
                    }
                ],
                apiPrefix: '',
                charset: 'utf-8'
            }, false);
        })
    });
</script>

<div id="fixed-trigger">
    <img src="http://gtms04.alicdn.com/tps/i4/T1fLWPXwJiXXbLJ07Y-126-213.jpg" usemap="#Map22" border="0" style="margin-right:12px;" />
    <map name="Map22">
        <area shape="rect" coords="5,166,122,210" href="http://we.taobao.com/" target="_blank">
    </map>

</div>
<script src="http://a.tbcdn.cn/s/kissy/gallery/limitfixed/1.0/index-min.js?t=20130701201313"></script>
<script>
    KISSY.use('gallery/limitfixed/1.0/index', function (S, Limitfixed) {
        // elFixed是要浮动的元素。
        // elLimit是浮动的容器，确定了elFixed元素的浮动范围。若不传则默认为document对象
        S.DOM.get('#fixed-trigger').style.display="block"
        var limitfixed = Limitfixed(S.get('#fixed-trigger'), {
            // elFixed相对elLimit容器的浮动位置。具体值参考API
            align: ['top', 'right'],
            // elFixed相对elLimit容器的偏移量。
            offset: [0, 300],
            // 是否在elFixed的位置上构建占位元素。
            // 为了避免浮动以后的布局变动
            holder: false,
            // 自定义占位元素的className。
            // 默认占位元素只设置了宽高，可以通过class定义额外的样式。
            holderCls: "limitfixed-holder",
            // 是否强制使用绝对定位。默认只在ie6下使用绝对定位。
            forceAbs: false,
            // 是否缓存elLimit的位置信息。如果容器是在浮动的方向上的尺寸是固定的。
            // 那么设置为true，可以避免每次都去读元素的位置信息。
            cache: false
        });

        limitfixed.scroll()
    });
</script>

<input type="hidden" value="2881047" id="J_ZDMBannerId"/><?php include("/home/admin/go/rgn/cuxiaohui/shh.php");?>